<!DOCTYPE html>
<html lang="fr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Lampe à Lave Secrète</title>
    <style>
        body { margin: 0; background: #000; color: #fff; font-family: Arial, sans-serif; overflow: hidden; }
        #login {
            position: absolute; top: 0; left: 0; width: 100%; height: 100%;
            display: flex; flex-direction: column; justify-content: center; align-items: center;
            background: radial-gradient(circle, #111, #000);
            z-index: 10;
        }
        #login h2 { font-size: 3em; margin-bottom: 20px; }
        #login input { padding: 15px; font-size: 1.2em; width: 300px; margin: 20px; border-radius: 10px; }
        #login button { padding: 15px 30px; font-size: 1.2em; background: #ff4500; border: none; border-radius: 10px; cursor: pointer; }
        #login button:hover { background: #ff6347; }
        #erreur { color: red; margin-top: 20px; display: none; }

        #contenu { display: none; width: 100%; height: 100vh; position: relative; }
        canvas { display: block; }

        .buttons {
            position: absolute; bottom: 20px; left: 50%; transform: translateX(-50%);
            display: flex; gap: 20px; z-index: 5;
        }
        .buttons button {
            padding: 15px 30px; font-size: 1.5em; background: rgba(255,255,255,0.2);
            border: 2px solid #fff; border-radius: 50px; color: #fff; cursor: pointer;
            backdrop-filter: blur(10px); transition: all 0.3s;
        }
        .buttons button:hover { background: rgba(255,100,100,0.4); transform: scale(1.1); }
    </style>
</head>
<body>

<div id="login">
    <h2>Lampe à Lave Secrète</h2>
    <p>Entre le mot de passe pour accéder à la magie...</p>
    <input type="password" id="password" placeholder="Mot de passe">
    <button onclick="verifier()">Entrer</button>
    <p id="erreur">Mot de passe incorrect ! Essaie encore.</p>
</div>

<div id="contenu">
    <canvas id="canvas"></canvas>
    <div class="buttons">
        <button onclick="ajouterBlobAleatoire()">Pop !</button>
        <button onclick="ajouterBlobCentre()">Bullez-moi</button>
        <button onclick="ajouterBlobAleatoire()">Satisfaisant</button>
        <button onclick="ajouterBlobCentre()">Lave +</button>
    </div>
</div>

<script>
// Mot de passe (change-le !)
const motDePasseCorrect = "lavalamp2025";

// Sons satisfaisants en base64 (pop de bulle et clic doux)
const sounds = [
    new Audio("data:audio/wav;base64,UklGRiQAAABXQVZFZm10IBAAAAABAAEAQB8AAEAfAAABAAgAZGF0YQAAAAAA"),
    new Audio("data:audio/mp3;base64,/+MYxAAAAANIAAAAAExBTUUzLjk4LjIAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA"),
    // Sons réels simples (pop bubble et click) - j'ai intégré des placeholders courts ; remplace par de vrais si tu veux
    // Pour de vrais sons, utilise des liens comme : https://mixkit.co/free-sound-effects/click/ ou https://freesound.org/
    // Exemple réel pop : new Audio("https://assets.mixkit.co/sfx/preview/mixkit-bubble-pop-2803.mp3")
    new Audio("https://cdn.freesound.org/previews/387/387182_5123856-lq.mp3"), // bubble pop gratuit
    new Audio("https://cdn.freesound.org/previews/341/341695_4282087-lq.mp3")  // click satisfaisant
];

function playSound() {
    const sound = sounds[Math.floor(Math.random() * sounds.length)];
    sound.currentTime = 0;
    sound.play();
}

function verifier() {
    const saisie = document.getElementById("password").value;
    if (saisie === motDePasseCorrect) {
        document.getElementById("login").style.display = "none";
        document.getElementById("contenu").style.display = "block";
        initLavaLamp();
    } else {
        document.getElementById("erreur").style.display = "block";
    }
}

// --- Partie Lampe à Lave Interactive ---
let canvas, ctx, width, height;
let balls = [];

class Metaball {
    constructor(x, y, radius = 50 + Math.random() * 50) {
        this.x = x;
        this.y = y;
        this.radius = radius;
        this.vx = (Math.random() - 0.5) * 2;
        this.vy = -1 - Math.random() * 1; // Monte lentement
        this.color = `hsl(${Math.random()*360}, 80%, 60%)`;
    }
    update() {
        this.x += this.vx;
        this.y += this.vy;
        this.vy += 0.02; // Gravité légère (tombe doucement)

        // Rebond aux bords
        if (this.x < this.radius || this.x > width - this.radius) this.vx *= -1;
        if (this.y < this.radius) this.vy *= -0.8;
        if (this.y > height - this.radius) {
            this.vy *= -0.8;
            this.y = height - this.radius;
        }
    }
}

function initLavaLamp() {
    canvas = document.getElementById("canvas");
    ctx = canvas.getContext("2d");
    resize();
    window.addEventListener("resize", resize);

    // Ajouter quelques blobs initiaux
    for (let i = 0; i < 8; i++) {
        balls.push(new Metaball(Math.random() * width, height - Math.random() * 200));
    }

    canvas.addEventListener("click", (e) => {
        const rect = canvas.getBoundingClientRect();
        ajouterBlob(e.clientX - rect.left, e.clientY - rect.top);
    });

    animate();
}

function resize() {
    width = canvas.width = window.innerWidth;
    height = canvas.height = window.innerHeight;
}

function ajouterBlob(x, y) {
    balls.push(new Metaball(x, y));
    playSound();
}

function ajouterBlobAleatoire() {
    ajouterBlob(Math.random() * width, height * 0.8 + Math.random() * height * 0.2);
}

function ajouterBlobCentre() {
    ajouterBlob(width / 2, height / 2);
}

function renderMetaballs() {
    const imageData = ctx.getImageData(0, 0, width, height);
    const data = imageData.data;

    for (let y = 0; y < height; y += 4) {
        for (let x = 0; x < width; x += 4) {
            let sum = 0;
            for (const ball of balls) {
                const dx = x - ball.x;
                const dy = y - ball.y;
                const d = Math.sqrt(dx*dx + dy*dy);
                if (d < ball.radius * 2) {
                    sum += ball.radius * 10 / (d + 1);
                }
            }
            if (sum > 1) {
                const intensity = Math.min(sum / 3, 1);
                const idx = (y * width + x) * 4;
                // Couleur mixée des blobs proches
                data[idx] = 255 * intensity;     // R
                data[idx+1] = 100 * intensity;   // G
                data[idx+2] = 200 * intensity;   // B
                data[idx+3] = 255;
            }
        }
    }
    ctx.putImageData(imageData, 0, 0);
}

function animate() {
    ctx.fillStyle = "#0a001f";
    ctx.fillRect(0, 0, width, height);

    balls.forEach(ball => ball.update());
    renderMetaballs();

    requestAnimationFrame(animate);
}
</script>

</body>
</html>
